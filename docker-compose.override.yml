services:
    spring-api:
        ports:
            - '8080:8080'
        environment:
            SPRING_PROFILES_ACTIVE: dev
    webapp:
        build:
            context: ./webapp
            target: dev
            args:
                VITE_API_BASE_URL: "."
        command: npm run dev -- --host
        ports:
            - '5173:5173'
        healthcheck:
            test: ['CMD', 'wget', '--no-verbose', '--tries=1', '--spider', 'http://127.0.0.1:5173/']
            interval: 2s
            timeout: 2s
            retries: 2
            start_period: 5s
    reverse-proxy:
        profiles:
            - with-proxy
